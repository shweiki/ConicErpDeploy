(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6c5d9b0a"],{"082d":function(e,t,o){"use strict";o("2014")},2014:function(e,t,o){},"335e":function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",(function(){return PrintReport})),__webpack_require__.d(__webpack_exports__,"d",(function(){return VisualizationReportHtml})),__webpack_require__.d(__webpack_exports__,"a",(function(){return DownloadReportAsImage})),__webpack_require__.d(__webpack_exports__,"c",(function(){return ReportAsDataUrl}));var core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("a481"),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_0__),regenerator_runtime_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("96cf"),regenerator_runtime_runtime__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(regenerator_runtime_runtime__WEBPACK_IMPORTED_MODULE_1__),C_ErpSolution_VueJs_Conic_Erp_Ui_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("1da1"),core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("ac6a"),core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_3__),_store__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("4360"),_api_Report__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("12b6"),_Visualization__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("1428"),html_to_image__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("e774"),_api_Email__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("cce5"),jsprintmanager__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("cfc2"),jsprintmanager__WEBPACK_IMPORTED_MODULE_9___default=__webpack_require__.n(jsprintmanager__WEBPACK_IMPORTED_MODULE_9__),downloadjs__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("aeb1"),downloadjs__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(downloadjs__WEBPACK_IMPORTED_MODULE_10__),_Report_ShawermaSheesh__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("6a83"),_Report_OrderReceipt__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("2520");function PrintReport(Type,Data){var JSPMT=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(_api_Report__WEBPACK_IMPORTED_MODULE_5__["e"])({Type:Type}).then((function(res){res.forEach((function(item,index){if(JSPMT)if(jsprintmanager__WEBPACK_IMPORTED_MODULE_9___default.a.JSPrintManager.auto_reconnect){var ShawermaSheesh=_Report_ShawermaSheesh__WEBPACK_IMPORTED_MODULE_11__["a"],OrderReceipt=_Report_OrderReceipt__WEBPACK_IMPORTED_MODULE_12__["a"];eval(item.Name+"("+JSON.stringify(Data)+(item.Printer?",`"+item.Printer+"`)":")"))}else jsprintmanager__WEBPACK_IMPORTED_MODULE_9___default.a.JSPrintManager.auto_reconnect=!0,jsprintmanager__WEBPACK_IMPORTED_MODULE_9___default.a.JSPrintManager.start(),jsprintmanager__WEBPACK_IMPORTED_MODULE_9___default.a.JSPrintManager.WS.onStatusChanged=function(){_store__WEBPACK_IMPORTED_MODULE_4__["a"].dispatch("app/setPrinters"),PrintReport(Type,Data,JSPMT)};else{item.Html=Object(_Visualization__WEBPACK_IMPORTED_MODULE_6__["a"])(Data,item.Html,"Set");try{var oIframe=document.getElementById("ifrmPrint"),oDoc=oIframe.contentWindow||oIframe.contentDocument;oDoc.document&&(oDoc=oDoc.document),oDoc.write("<head><title>title</title>"),oDoc.write('</head><body onload="this.focus(); this.print();">'),oDoc.write(item.Html+"</body>"),oDoc.close(),setTimeout((function(){document.getElementById("ifrmPrint").src=""}),2e3)}catch(e){self.print()}}}))}))}function SendReportByEmail(e,t,o){var r=this,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";Object(_api_Report__WEBPACK_IMPORTED_MODULE_5__["e"])({Type:t}).then((function(t){t.forEach(function(){var t=Object(C_ErpSolution_VueJs_Conic_Erp_Ui_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_2__["a"])(regeneratorRuntime.mark((function t(a,i){var _;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a.Html=Object(_Visualization__WEBPACK_IMPORTED_MODULE_6__["a"])(o,a.Html,"Set"),t.next=3,Object(_api_Email__WEBPACK_IMPORTED_MODULE_8__["a"])({to:e,subject:a.Name+" - "+n,body:a.Html});case 3:_=t.sent,r.$notify({title:"تم الإضافة بنجاح",message:"تم ارسال "+_,type:"success",position:"top-left",duration:3e3});case 5:case"end":return t.stop()}}),t)})));return function(e,o){return t.apply(this,arguments)}}())}))}function VisualizationReportHtml(e,t){return new Promise((function(o,r){Object(_api_Report__WEBPACK_IMPORTED_MODULE_5__["e"])({Type:e}).then((function(e){e.forEach((function(e,o){e.Html=Object(_Visualization__WEBPACK_IMPORTED_MODULE_6__["a"])(t,e.Html,"Set")})),o(e.map((function(e){return e.Html})))})).catch((function(e){r(e)}))}))}function DownloadReportAsImage(e,t){return new Promise((function(o,r){Object(_api_Report__WEBPACK_IMPORTED_MODULE_5__["e"])({Type:e}).then((function(e){e.forEach((function(e,o){var r=document.getElementById("DownloadAsImage"),n=r.contentWindow||r.contentDocument;n.document&&(n=n.document),n.write(Object(_Visualization__WEBPACK_IMPORTED_MODULE_6__["a"])(t,e.Html,"Set")),html_to_image__WEBPACK_IMPORTED_MODULE_7__["a"](n.body).then((function(e){downloadjs__WEBPACK_IMPORTED_MODULE_10___default()(e,t.Name.replaceAll("'","")+".png"),n.close()})).catch((function(e){console.error("oops, something went wrong!",e)}))})),o(e.map((function(e){return e.Html})))})).catch((function(e){r(e)}))}))}function ReportAsDataUrl(e,t){return new Promise((function(o,r){Object(_api_Report__WEBPACK_IMPORTED_MODULE_5__["e"])({Type:e}).then((function(e){e.forEach((function(e,r){var n=document.getElementById("DownloadAsImage"),a=n.contentWindow||n.contentDocument;a.document&&(a=a.document),a.write(Object(_Visualization__WEBPACK_IMPORTED_MODULE_6__["a"])(t,e.Html,"Set")),html_to_image__WEBPACK_IMPORTED_MODULE_7__["a"](a.body).then((function(e){o(e.replace(/^data:image\/(png|jpg);base64,/,"")),a.close()})).catch((function(e){console.error("oops, something went wrong!",e)}))}))})).catch((function(e){r(e)}))}))}},"44a4":function(e,t,o){"use strict";o.d(t,"e",(function(){return i})),o.d(t,"f",(function(){return _})),o.d(t,"a",(function(){return s})),o.d(t,"b",(function(){return c})),o.d(t,"c",(function(){return u})),o.d(t,"d",(function(){return l}));var r=o("b7e2"),n=o("4328"),a=o.n(n);function i(e){return Object(r["a"])({url:"/Visit/GetByListQ",method:"post",data:a.a.stringify(e)})}function _(e){return Object(r["a"])({url:"/Visit/GetByStatus",method:"get",params:e})}function s(e){return Object(r["a"])({url:"/Visit/Create",method:"post",data:a.a.stringify(e)})}function c(e){return Object(r["a"])({url:"/Visit/Edit",method:"post",data:a.a.stringify(e)})}function u(e){return Object(r["a"])({url:"/Visit/GetById",method:"get",params:e})}function l(e){return Object(r["a"])({url:"/Visit/GetByListId",method:"get",params:e})}},7939:function(e,t,o){"use strict";var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"app-container"},[o("el-form",{ref:"tempForm",staticClass:"demo-ruleForm",attrs:{model:e.tempForm,"label-position":"top","label-width":"70px"}},[o("el-row",{staticClass:"card",attrs:{type:"flex"}},[o("el-col",{attrs:{span:18}},[o("Drawer-Print",{attrs:{disabled:null!=e.OldVisit,Type:"Visit",Data:e.OldVisit}})],1),e._v(" "),o("el-col",{attrs:{span:3}},[o("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},model:{value:e.AutoPrint,callback:function(t){e.AutoPrint=t},expression:"AutoPrint"}})],1),e._v(" "),o("el-col",{attrs:{span:3}},[o("el-button",{staticStyle:{float:"left"},attrs:{disabled:e.DisabledSave,type:"success",icon:"fa fa-save"},on:{click:function(t){return e.confirmData()}}},[e._v(e._s(1!=e.isEdit?"حفظ":"تعديل"))])],1)],1),e._v(" "),o("el-row",{attrs:{type:"flex"}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{prop:"FakeDate",label:e.$t("Visit.ReleaseDate"),rules:[{required:!0,message:"لايمكن ترك التاريخ فارغ",trigger:"blur"}]}},[o("Fake-Date",{attrs:{Value:e.tempForm.FakeDate},on:{Set:function(t){return e.tempForm.FakeDate=t}}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:e.$t("Visit.PaymentMethod"),prop:"PaymentMethod"}},[o("el-radio-group",{attrs:{"text-color":"#f78123"},model:{value:e.tempForm.PaymentMethod,callback:function(t){e.$set(e.tempForm,"PaymentMethod",t)},expression:"tempForm.PaymentMethod"}},[o("el-radio",{attrs:{label:"Cash",border:""}},[e._v(e._s(e.$t("Visit.Cash")))]),e._v(" "),o("el-radio",{attrs:{label:"Visa",border:""}},[e._v(e._s(e.$t("Visit.Visa")))]),e._v(" "),o("el-radio",{attrs:{label:"Coupon",border:""}},[e._v(e._s(e.$t("Visit.Coupon")))])],1)],1)],1)],1),e._v(" "),o("el-row",{attrs:{type:"flex"}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:e.$t("Visit.Name"),prop:"Name",rules:[{required:!0,message:"لايمكن ترك التاريخ فارغ",trigger:"blur"}]}},[o("el-input",{attrs:{required:"",size:e.$store.getters.size,"suffix-icon":"fa fa-child"},model:{value:e.tempForm.Name,callback:function(t){e.$set(e.tempForm,"Name",t)},expression:"tempForm.Name"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:e.$t("Visit.PhoneNumber")}},[o("el-input",{attrs:{required:"",size:e.$store.getters.size,"suffix-icon":"fa fa-mobile-alt"},model:{value:e.tempForm.PhoneNumber,callback:function(t){e.$set(e.tempForm,"PhoneNumber",t)},expression:"tempForm.PhoneNumber"}})],1)],1)],1),e._v(" "),"Coupon"!=e.tempForm.PaymentMethod?o("el-row",{attrs:{type:"flex"}},[o("el-col",{attrs:{span:8}},[o("el-form-item",{attrs:{label:e.$t("Visit.PersonCount"),prop:"PersonCount"}},[o("el-input-number",{attrs:{size:e.$store.getters.size,precision:0,step:1,min:1,max:1e6},on:{focus:function(e){return e.target.select()}},model:{value:e.tempForm.PersonCount,callback:function(t){e.$set(e.tempForm,"PersonCount",t)},expression:"tempForm.PersonCount"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:8}},[o("el-form-item",{attrs:{label:e.$t("Visit.HourCount"),prop:"HourCount"}},[o("el-input-number",{attrs:{size:e.$store.getters.size,precision:2,step:.5,min:.5,max:18},on:{focus:function(e){return e.target.select()}},model:{value:e.tempForm.HourCount,callback:function(t){e.$set(e.tempForm,"HourCount",t)},expression:"tempForm.HourCount"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:8}},[o("el-form-item",{attrs:{label:e.$t("Visit.HourPrice"),prop:"HourPrice"}},[o("el-input-number",{attrs:{disabled:!e.checkPermission(["admin"]),size:e.$store.getters.size,precision:0,step:1,min:1,max:1e6},on:{focus:function(e){return e.target.select()}},model:{value:e.tempForm.HourPrice,callback:function(t){e.$set(e.tempForm,"HourPrice",t)},expression:"tempForm.HourPrice"}})],1)],1)],1):e._e(),e._v(" "),"Coupon"==e.tempForm.PaymentMethod?o("el-row",{attrs:{type:"flex"}},[o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:e.$t("Visit.CouponId"),prop:"CouponId"}},[o("el-input",{attrs:{size:e.$store.getters.size,"suffix-icon":"fa fa-ticket-alt"},on:{focus:function(e){return e.target.select()}},model:{value:e.tempForm.CouponId,callback:function(t){e.$set(e.tempForm,"CouponId",t)},expression:"tempForm.CouponId"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:12}},[o("el-form-item",{attrs:{label:e.$t("Visit.CouponNoteId"),prop:"CouponNoteId"}},[o("el-input",{attrs:{size:e.$store.getters.size,"suffix-icon":"fa fa-book"},on:{focus:function(e){return e.target.select()}},model:{value:e.tempForm.CouponNoteId,callback:function(t){e.$set(e.tempForm,"CouponNoteId",t)},expression:"tempForm.CouponNoteId"}})],1)],1)],1):e._e(),e._v(" "),o("el-row",{attrs:{type:"flex"}},[o("el-col",[o("span",{staticStyle:{color:"#f56c6c","font-size":"16px","text-align":"center"}},[e._v(e._s(e.ValidateNote))])])],1),e._v(" "),o("el-row",{attrs:{type:"flex"}},[o("el-col",{attrs:{span:8}},[o("span",{staticStyle:{"font-size":"18px"}},[e._v(e._s(e.$t("Visit.statement")))]),e._v(" "),o("el-form-item",{attrs:{prop:"Description"}},[o("el-input",{attrs:{type:"textarea"},model:{value:e.tempForm.Description,callback:function(t){e.$set(e.tempForm,"Description",t)},expression:"tempForm.Description"}})],1)],1),e._v(" "),o("el-col",{attrs:{span:8}},[o("span",{staticStyle:{"font-size":"18px"}},[e._v("خصم")]),e._v(" "),o("el-form-item",{attrs:{prop:"Discount"}},[o("el-input-number",{attrs:{precision:2,step:1,min:0,max:100},on:{focus:function(e){return e.target.select()}},model:{value:e.tempForm.Discount,callback:function(t){e.$set(e.tempForm,"Discount",t)},expression:"tempForm.Discount"}})],1)],1),e._v(" "),o("el-col",{staticClass:"TotalAmmount card",attrs:{span:8}},[o("span",[e._v(e._s(e.$t("Visit.TotalJD")))]),e._v(" "),o("span",[e._v(e._s((e.tempForm.PersonCount*(2*e.tempForm.HourCount)*e.tempForm.HourPrice-e.tempForm.Discount).toFixed(e.$store.getters.settings.ToFixed))+"\n          JOD")])])],1)],1)],1)},n=[],a=(o("96cf"),o("1da1")),i=o("44a4"),_=o("4742"),s=o("e350"),c=o("335e"),u=o("2cba"),l=o("ed08"),m={name:"Visit",components:{FakeDate:_["a"],DrawerPrint:u["a"]},props:{isEdit:{type:Boolean,default:!1}},data:function(){return{OldVisit:null,AutoPrint:!0,ValidateNote:"",DisabledSave:!1,tempForm:{Id:void 0,Name:"",Tax:0,FakeDate:"",PaymentMethod:"Cash",Discount:0,Status:0,PersonCount:1,HourCount:.5,HourPrice:1,PhoneNumber:"",Type:"",Description:""},tempRoute:{}}},created:function(){this.isEdit&&this.getdata(this.$route.params&&this.$route.params.id),this.tempRoute=Object.assign({},this.$route)},methods:{checkPermission:s["a"],getdata:function(e){var t=this;Object(i["c"])({Id:e}).then((function(e){t.tempForm=e,t.setTagsViewTitle(),t.setPageTitle()})).catch((function(e){console.log(e)}))},restTempForm:function(){this.tempForm={Id:void 0,Name:"",Tax:0,FakeDate:"",PaymentMethod:"Cash",Discount:0,Status:0,PersonCount:1,HourCount:.5,HourPrice:1,PhoneNumber:"",Type:"",Description:""}},confirmData:function(){var e=this;this.$refs["tempForm"].validate(function(){var t=Object(a["a"])(regeneratorRuntime.mark((function t(o){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("Coupon"==e.tempForm.PaymentMethod&&(e.tempForm.PersonCount=1,e.tempForm.HourCount=.5,e.tempForm.HourPrice=0,e.tempForm.Description="كوبون رقم "+e.tempForm.CouponId+" من دفتر رقم "+e.tempForm.CouponNoteId+" "),e.tempForm.Total=(e.tempForm.PersonCount*(2*e.tempForm.HourCount)*e.tempForm.HourPrice-e.tempForm.Discount).toFixed(e.$store.getters.settings.ToFixed),!o){t.next=21;break}if(e.tempForm.Tax=parseInt(e.tempForm.Tax),e.DisabledSave=!0,e.tempForm.FakeDate=Object(l["a"])(),e.tempForm.TimeOut=Object(l["d"])(new Date,e.tempForm.HourCount),1==e.isEdit){t.next=13;break}return t.next=10,Object(i["a"])(e.tempForm).then((function(e){return e||!1})).catch((function(e){return!1}));case 10:r=t.sent,t.next=16;break;case 13:return t.next=15,Object(i["b"])(e.tempForm).then((function(e){return e||!1})).catch((function(e){return!1}));case 15:r=t.sent;case 16:r?(e.tempForm.Id=r,e.OldVisit=e.tempForm,1==e.AutoPrint&&Object(c["b"])("Visit",e.OldVisit),e.DisabledSave=!1,e.restTempForm(),e.$notify({title:"تم الإضافة بنجاح",message:"تم الإضافة بنجاح",type:"success",position:"top-left",duration:1e3,showClose:!1})):e.$notify({title:"مشكلة",message:"حصلت مشكلة في عملية الحفظ",type:"error",position:"top-left",duration:1e3,showClose:!1}),e.restTempForm(),e.DisabledSave=!1,t.next=24;break;case 21:return e.ValidateNote="القيمة الإجمالية تساوي صفر  ",e.DisabledSave=!1,t.abrupt("return",!1);case 24:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},setTagsViewTitle:function(){var e="Edit Visit",t=Object.assign({},this.tempRoute,{title:"".concat(e,"-").concat(this.tempForm.Id)});this.$store.dispatch("tagsView/updateVisitdView",t)},setPageTitle:function(){var e="Edit Visit";document.title="".concat(e," - ").concat(this.tempForm.Id)}}},p=m,d=(o("082d"),o("2877")),f=Object(d["a"])(p,r,n,!1,null,"5faab335",null);t["a"]=f.exports},"974c":function(e,t,o){"use strict";o.r(t);var r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",["Public"==e.$store.getters.settings.Visit.Layout?o("Public",{attrs:{"is-edit":!0}}):e._e()],1)},n=[],a=o("7939"),i={name:"EditVisit",components:{Public:a["a"]}},_=i,s=o("2877"),c=Object(s["a"])(_,r,n,!1,null,null,null);t["default"]=c.exports},aeb1:function(e,t,o){var r,n,a;(function(o,i){n=[],r=i,a="function"===typeof r?r.apply(t,n):r,void 0===a||(e.exports=a)})(0,(function(){return function e(t,o,r){var n,a,i=window,_="application/octet-stream",s=r||_,c=t,u=!o&&!r&&c,l=document.createElement("a"),m=function(e){return String(e)},p=i.Blob||i.MozBlob||i.WebKitBlob||m,d=o||"download";if(p=p.call?p.bind(i):Blob,"true"===String(this)&&(c=[c,s],s=c[0],c=c[1]),u&&u.length<2048&&(d=u.split("/").pop().split("?")[0],l.href=u,-1!==l.href.indexOf(u))){var f=new XMLHttpRequest;return f.open("GET",u,!0),f.responseType="blob",f.onload=function(t){e(t.target.response,d,_)},setTimeout((function(){f.send()}),0),f}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(c)){if(!(c.length>2096103.424&&p!==m))return navigator.msSaveBlob?navigator.msSaveBlob(D(c),d):O(c);c=D(c),s=c.type||_}else if(/([\x80-\xff])/.test(c)){var b=0,E=new Uint8Array(c.length),P=E.length;for(b;b<P;++b)E[b]=c.charCodeAt(b);c=new p([E],{type:s})}function D(e){var t=e.split(/[:;,]/),o=t[1],r="base64"==t[2]?atob:decodeURIComponent,n=r(t.pop()),a=n.length,i=0,_=new Uint8Array(a);for(i;i<a;++i)_[i]=n.charCodeAt(i);return new p([_],{type:o})}function O(e,t){if("download"in l)return l.href=e,l.setAttribute("download",d),l.className="download-js-link",l.innerHTML="downloading...",l.style.display="none",document.body.appendChild(l),setTimeout((function(){l.click(),document.body.removeChild(l),!0===t&&setTimeout((function(){i.URL.revokeObjectURL(l.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,_)),window.open(e)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=e),!0;var o=document.createElement("iframe");document.body.appendChild(o),!t&&/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,_)),o.src=e,setTimeout((function(){document.body.removeChild(o)}),333)}if(n=c instanceof p?c:new p([c],{type:s}),navigator.msSaveBlob)return navigator.msSaveBlob(n,d);if(i.URL)O(i.URL.createObjectURL(n),!0);else{if("string"===typeof n||n.constructor===m)try{return O("data:"+s+";base64,"+i.btoa(n))}catch(h){return O("data:"+s+","+encodeURIComponent(n))}a=new FileReader,a.onload=function(e){O(this.result)},a.readAsDataURL(n)}return!0}}))}}]);